webpackJsonp([1],{"/TZm":function(t,e){},"0uvK":function(t,e){t.exports.PicOptions=[{name:"通用文字识别",command:"general_basic"},{name:"通用文字识别（高精度版）",command:"accurate_basic"},{name:"通用文字识别（含位置信息版）",command:"general"},{name:"通用文字识别（含位置信息、高精度版）",command:"accurate"},{name:"网络图片文字识别",command:"webimage"},{name:"身份证识别",command:"idcard"},{name:"银行卡识别",command:"bankcard"},{name:"驾驶证识别",command:"driving_license"},{name:"行驶证识别",command:"vehicle_license"},{name:"车牌识别",command:"license_plate"},{name:"营业执照识别",command:"business_license"},{name:"护照识别",command:"passport"},{name:"名片识别",command:"business_card"},{name:"表格文字识别",command:"form_ocr_request"},{name:"通用票据识别",command:"receipt"},{name:"二维码识别",command:"qrcode"}],t.exports.OcrType={general_basic:"general_basic",accurate_basic:"accurate_basic",general:"general",accurate:"accurate",webimage:"webimage",idcard:"idcard",bankcard:"bankcard",driving_license:"driving_license",vehicle_license:"vehicle_license",license_plate:"license_plate",business_license:"business_license",passport:"passport",business_card:"business_card",form_ocr_request:"form_ocr/request",form_ocr_get_request_result:"form_ocr/get_request_result",receipt:"receipt",qrcode:"qrcode"}},"7qfE":function(t,e){},HjtZ:function(t,e){},LnGP:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("7+uW"),a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("mt-header",{attrs:{fixed:"",title:this.title}},[this.backButtonState?e("mt-button",{attrs:{slot:"left",icon:"back"},on:{click:this.handleBack},slot:"left"},[this._v("返回")]):this._e()],1),this._v(" "),e("router-view")],1)},staticRenderFns:[]};var r=s("VU/8")({name:"App",computed:{title:function(){switch(this.$route.name){case"home":return"图片文字识别";case"FormOcr":case"UploadForm":return"表格图片识别";case"CardOcr":case"UploadCard":return"批量名片识别";default:return"图片文字识别"}},backButtonState:function(){return"/home"!==this.$route.path&&"/"!==this.$route.path}},methods:{handleBack:function(){this.$router.go(-1)}}},a,!1,function(t){s("ydBP")},null,null).exports,n=s("/ocq"),o=s("//Fk"),l=s.n(o),c=s("0uvK").OcrType,d={name:"result",props:["wordsResult","type"],data:function(){return{ocrType:c}}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",[t._v("识别结果")])]),t._v(" "),t.type==t.ocrType.idcard?s("div",{staticClass:"result-container"},[t.wordsResult["住址"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("姓名")]),s("span",[t._v(" "+t._s(t.wordsResult["姓名"].words))])],1):t._e(),t._v(" "),t.wordsResult["性别"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("性别")]),s("span",[t._v(" "+t._s(t.wordsResult["性别"].words))])],1):t._e(),t._v(" "),t.wordsResult["民族"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("民族")]),s("span",[t._v(" "+t._s(t.wordsResult["民族"].words))])],1):t._e(),t._v(" "),t.wordsResult["住址"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("住址")]),s("span",[t._v(" "+t._s(t.wordsResult["住址"].words))])],1):t._e(),t._v(" "),t.wordsResult["公民身份号码"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("公民身份号码")]),s("span",[t._v(" "+t._s(t.wordsResult["公民身份号码"].words))])],1):t._e(),t._v(" "),t.wordsResult["出生"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("出生")]),s("span",[t._v(" "+t._s(t.wordsResult["出生"].words))])],1):t._e()]):t._e(),t._v(" "),t.type==t.ocrType.bankcard?s("div",{staticClass:"result-container"},[t.wordsResult.bank_card_number?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("银行卡号")]),s("span",[t._v(" "+t._s(t.wordsResult.bank_card_number))])],1):t._e(),t._v(" "),t.wordsResult.bank_name?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("银行名")]),s("span",[t._v(" "+t._s(t.wordsResult.bank_name))])],1):t._e(),t._v(" "),t.wordsResult.bank_card_type?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("银行卡类型")]),s("span",[t._v(" "+t._s(1==t.wordsResult.bank_card_type?"借记卡":"信用卡"))])],1):t._e()]):t._e(),t._v(" "),t.type==t.ocrType.driving_license?s("div",{staticClass:"result-container"},[t.wordsResult["证号"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("证号")]),s("span",[t._v(" "+t._s(t.wordsResult["证号"].words))])],1):t._e(),t._v(" "),t.wordsResult["有效期限"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("有效期限")]),s("span",[t._v(" "+t._s(t.wordsResult["有效期限"].words))])],1):t._e(),t._v(" "),t.wordsResult["准驾车型"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("准驾车型")]),s("span",[t._v(" "+t._s(t.wordsResult["准驾车型"].words))])],1):t._e(),t._v(" "),t.wordsResult["有效起始日期"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("有效起始日期")]),s("span",[t._v(" "+t._s(t.wordsResult["有效起始日期"].words))])],1):t._e(),t._v(" "),t.wordsResult["住址"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("住址")]),s("span",[t._v(" "+t._s(t.wordsResult["住址"].words))])],1):t._e(),t._v(" "),t.wordsResult["姓名"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("姓名")]),s("span",[t._v(" "+t._s(t.wordsResult["姓名"].words))])],1):t._e(),t._v(" "),t.wordsResult["国籍"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("国籍")]),s("span",[t._v(" "+t._s(t.wordsResult["国籍"].words))])],1):t._e(),t._v(" "),t.wordsResult["出生日期"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("出生日期")]),s("span",[t._v(" "+t._s(t.wordsResult["出生日期"].words))])],1):t._e(),t._v(" "),t.wordsResult["性别"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("性别")]),s("span",[t._v(" "+t._s(t.wordsResult["性别"].words))])],1):t._e(),t._v(" "),t.wordsResult["初次领证日期"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("初次领证日期")]),s("span",[t._v(" "+t._s(t.wordsResult["初次领证日期"].words))])],1):t._e()]):t._e(),t._v(" "),t.type==t.ocrType.vehicle_license?s("div",{staticClass:"result-container"},[t.wordsResult["品牌型号"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("品牌型号")]),s("span",[t._v(" "+t._s(t.wordsResult["品牌型号"].words))])],1):t._e(),t._v(" "),t.wordsResult["发证日期"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("发证日期")]),s("span",[t._v(" "+t._s(t.wordsResult["发证日期"].words))])],1):t._e(),t._v(" "),t.wordsResult["使用性质"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("使用性质")]),s("span",[t._v(" "+t._s(t.wordsResult["使用性质"].words))])],1):t._e(),t._v(" "),t.wordsResult["发动机号码"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("发动机号码")]),s("span",[t._v(" "+t._s(t.wordsResult["发动机号码"].words))])],1):t._e(),t._v(" "),t.wordsResult["号牌号码"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("号牌号码")]),s("span",[t._v(" "+t._s(t.wordsResult["号牌号码"].words))])],1):t._e(),t._v(" "),t.wordsResult["所有人"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("所有人")]),s("span",[t._v(" "+t._s(t.wordsResult["所有人"].words))])],1):t._e(),t._v(" "),t.wordsResult["住址"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("住址")]),s("span",[t._v(" "+t._s(t.wordsResult["住址"].words))])],1):t._e(),t._v(" "),t.wordsResult["注册日期"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("注册日期")]),s("span",[t._v(" "+t._s(t.wordsResult["注册日期"].words))])],1):t._e(),t._v(" "),t.wordsResult["车辆识别代号"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("车辆识别代号")]),s("span",[t._v(" "+t._s(t.wordsResult["车辆识别代号"].words))])],1):t._e(),t._v(" "),t.wordsResult["车辆类型"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("车辆类型")]),s("span",[t._v(" "+t._s(t.wordsResult["车辆类型"].words))])],1):t._e()]):t._e(),t._v(" "),t.type==t.ocrType.license_plate?s("div",{staticClass:"result-container"},[t.wordsResult.number?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("车牌号")]),s("span",[t._v(" "+t._s(t.wordsResult.number))])],1):t._e()]):t._e(),t._v(" "),t.type==t.ocrType.business_license?s("div",{staticClass:"result-container"},[t.wordsResult["单位名称"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("单位名称")]),s("span",[t._v(" "+t._s(t.wordsResult["单位名称"].words))])],1):t._e(),t._v(" "),t.wordsResult["法人"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("法人")]),s("span",[t._v(" "+t._s(t.wordsResult["法人"].words))])],1):t._e(),t._v(" "),t.wordsResult["地址"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("地址")]),s("span",[t._v(" "+t._s(t.wordsResult["地址"].words))])],1):t._e(),t._v(" "),t.wordsResult["有效期"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("有效期")]),s("span",[t._v(" "+t._s(t.wordsResult["有效期"].words))])],1):t._e(),t._v(" "),t.wordsResult["证件编号"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("证件编号")]),s("span",[t._v(" "+t._s(t.wordsResult["证件编号"].words))])],1):t._e(),t._v(" "),t.wordsResult["社会信用代码"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("社会信用代码")]),s("span",[t._v(" "+t._s(t.wordsResult["社会信用代码"].words))])],1):t._e()]):t._e(),t._v(" "),t.type==t.ocrType.passport?s("div",{staticClass:"result-container"},[t.wordsResult["国家码"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("国家码")]),s("span",[t._v(" "+t._s(t.wordsResult["国家码"].words))])],1):t._e(),t._v(" "),t.wordsResult["护照签发地点"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("护照签发地点")]),s("span",[t._v(" "+t._s(t.wordsResult["护照签发地点"].words))])],1):t._e(),t._v(" "),t.wordsResult["有效期至"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("有效期至")]),s("span",[t._v(" "+t._s(t.wordsResult["有效期至"].words))])],1):t._e(),t._v(" "),t.wordsResult["护照号码"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("护照号码")]),s("span",[t._v(" "+t._s(t.wordsResult["护照号码"].words))])],1):t._e(),t._v(" "),t.wordsResult["姓名"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("姓名")]),s("span",[t._v(" "+t._s(t.wordsResult["姓名"].words))])],1):t._e(),t._v(" "),t.wordsResult["签发日期"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("签发日期")]),s("span",[t._v(" "+t._s(t.wordsResult["签发日期"].words))])],1):t._e(),t._v(" "),t.wordsResult["生日"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("生日")]),s("span",[t._v(" "+t._s(t.wordsResult["生日"].words))])],1):t._e(),t._v(" "),t.wordsResult["性别"]?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("性别")]),s("span",[t._v(" "+t._s(t.wordsResult["性别"].words))])],1):t._e()]):t._e(),t._v(" "),t.type==t.ocrType.business_card?s("div",{staticClass:"result-container"},[t.wordsResult.ADDR?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("地址")]),s("span",[t._v(" "+t._s(t.wordsResult.ADDR))])],1):t._e(),t._v(" "),t.wordsResult.FAX?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("传真")]),s("span",[t._v(" "+t._s(t.wordsResult.FAX))])],1):t._e(),t._v(" "),t.wordsResult.MOBILE?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("手机")]),s("span",[t._v(" "+t._s(t.wordsResult.MOBILE))])],1):t._e(),t._v(" "),t.wordsResult.NAME?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("姓名")]),s("span",[t._v(" "+t._s(t.wordsResult.NAME))])],1):t._e(),t._v(" "),t.wordsResult.PC?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("邮编")]),s("span",[t._v(" "+t._s(t.wordsResult.PC))])],1):t._e(),t._v(" "),t.wordsResult.URL?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("公司网址")]),s("span",[t._v(" "+t._s(t.wordsResult.URL))])],1):t._e(),t._v(" "),t.wordsResult.TEL?s("div",[s("el-tag",{attrs:{size:"medium"}},[t._v("电话")]),s("span",[t._v(" "+t._s(t.wordsResult.TEL))])],1):t._e()]):t._e(),t._v(" "),t.type==t.ocrType.qrcode?s("div",{staticClass:"result-container"},t._l(t.wordsResult,function(e){return s("div",{key:e.text},[s("el-tag",{attrs:{size:"medium"}},[t._v("识别结果(目前只显示第一个结果)")]),s("span",[t._v(" "+t._s(e.text[0]))])],1)})):s("div",t._l(t.wordsResult,function(e){return s("div",{key:e.words},[t._v(t._s(e.words))])}))])},staticRenderFns:[]};var _=s("VU/8")(d,u,!1,function(t){s("Q4kC")},null,null).exports,p=s("mw3O"),m=s("0uvK").PicOptions,v={name:"BaiduOCR",components:{result:_},data:function(){return{activeStep:1,currentSelectFileUrl:"",picTypeOptions:m,selectedOption:"",selectedCommand:"general_basic",selectedFileUrl:"",words_result:[],finishState:!1}},created:function(){this.init()},methods:{init:function(){console.log(p)},submitUpload:function(){this.activeStep=2,this.selectedFileUrl=this.currentSelectFileUrl},uploadSuccess:function(t,e,s){this.activeStep=2,this.selectedFileUrl=t.path,console.log(t)},changeUpload:function(t,e){var s=this;console.log(t.raw),this.getBase64(t.raw).then(function(t){console.log(t);var e=t.split(",");e=e[1],console.log(e),s.axios.post("/general_ocr",{image:e,access_token:"24.07ebcc57b741f34ea0c744a4bddd9ceb.2592000.1596114920.282335-18012314"},{headers:{dataType:"json",contentType:"application/json"}}).then(function(t){console.log(t),s.words_result=t.data.words_result})}),this.currentSelectFileUrl=t.url},getBase64:function(t){return new l.a(function(e,s){var i=new FileReader,a="";i.readAsDataURL(t),i.onload=function(){a=i.result},i.onerror=function(t){s(t)},i.onloadend=function(){e(a)}})},removeFile:function(t,e){this.currentSelectFileUrl=""},exceedFile:function(t){this.$message({message:"每次只能上传一张图片，请先删除当前图片",type:"warning"})},handleCommand:function(t){var e=this;this.finishState=!1,m.every(function(s,i){return s.command!==t||(e.selectedOption=s.name,!1)}),this.selectedCommand=t,this.activeStep=3},getOcr:function(){var t=this,e=p.stringify({imageUrl:this.selectedFileUrl,picType:this.selectedCommand});this.words_result=[];var s=this.selectedCommand;this.axios.post("./api/baidu_ocr_general",e).then(function(e){if(console.log(e),t.words_result=JSON.parse(e.data).words_result,"form_ocr_request"===s){var i=JSON.parse(e.data).result[0].request_id;setTimeout(t.requestFormFile(i),1e4)}t.finishState=!0})},getResult:function(){this.finishState=!0},restart:function(){this.activeStep=1,this.currentSelectFileUrl="",this.selectedCommand="",this.selectedFileUrl="",this.finishState=!1},requestFormFile:function(t){var e=this;this.axios.post("./api/baidu_ocr_general",p.stringify({picType:"form_ocr_get_request_result",requestId:t})).then(function(s){var i=JSON.parse(s.data).result.result_data;if(console.log(i),""===i)e.requestFormFile(t);else{var a=i.split("?")[0].split("/"),r=a[a.length-1],n=document.createElement("a");n.setAttribute("href",i),n.setAttribute("download",r),n.click()}})}}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",{staticClass:"card-title"},[t._v("图片文字识别Demo")])]),t._v(" "),s("div",{staticStyle:{"margin-bottom":"50px"}},[s("el-steps",{attrs:{active:t.activeStep,"align-center":""}},[s("el-step",{attrs:{title:"步骤 1",description:"先选择一张图片",icon:"el-icon-upload"}}),t._v(" "),s("el-step",{attrs:{title:"步骤 2",description:"选择图片的类型",icon:"el-icon-edit"}}),t._v(" "),s("el-step",{attrs:{title:"步骤 3",description:"获取图片识别结果",icon:"el-icon-check"}})],1)],1),t._v(" "),s("el-row",{attrs:{justify:"center",align:"middle"}},[1===t.activeStep?s("el-col",{attrs:{span:t.currentSelectFileUrl?12:24}},[s("el-upload",{ref:"upload ",staticClass:"upload-demo",attrs:{drag:"","auto-upload":!1,limit:1,"list-type":"'picture'",action:"./api/uploa d","on-success":t.uploadSuccess,"on-change":t.changeUpload,"on-exceed":t.exceedFile,"on-remove":t.removeFile,multiple:""}},[s("i",{staticClass:"el-icon-upload"}),t._v(" "),s("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),s("em",[t._v("点击上传")])]),t._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("大小不超过4M，最短边至少15px，最长边最大4096px,支持jpg/png/bmp格式")])]),t._v(" "),t.currentSelectFileUrl?s("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:t.submitUpload}},[t._v("上传到服务器")]):t._e()],1):t._e(),t._v(" "),t.currentSelectFileUrl?s("el-col",{attrs:{span:t.activeStep>1?24:12}},[s("span",{staticClass:"span-title"},[t._v("图片预览：")]),t._v(" "),s("img",{staticStyle:{height:"200px","margin-top":"20px"},attrs:{src:t.currentSelectFileUrl}})]):t._e()],1),t._v(" "),s("el-row",{staticStyle:{"margin-top":"50px"},attrs:{justify:"center",align:"middle"}},[t.currentSelectFileUrl&&t.activeStep>1?s("el-col",[s("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[s("el-button",{attrs:{type:"primary"}},[t._v("\n          "+t._s(t.selectedOption?t.selectedOption:"选择图片类型")),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.picTypeOptions,function(e){return s("el-dropdown-item",{key:e.name,attrs:{command:e.command}},[t._v(t._s(e.name))])}))],1)],1):t._e()],1),t._v(" "),s("el-row",{staticStyle:{"margin-top":"50px"},attrs:{justify:"center",align:"middle"}},[t.activeStep>2?s("el-col",{attrs:{span:24}},[s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.getResult()}}},[t._v("\n        获取图片识别结果\n      ")]),t._v(" "),t.finishState?s("result",{staticStyle:{"margin-top":"50px"},attrs:{wordsResult:t.words_result,type:t.selectedCommand}}):t._e(),t._v(" "),t.finishState?s("div",[s("span",{staticClass:"span-title"},[t._v("识别结果（裸字符）：")]),t._v(" "),s("p",[t._v(t._s(t.words_result))])]):t._e(),t._v(" "),t.finishState?s("el-button",{attrs:{type:"success"},on:{click:t.restart}},[t._v("\n        再识别一张图片\n      ")]):t._e()],1):t._e()],1)],1)},staticRenderFns:[]};var f=s("VU/8")(v,h,!1,function(t){s("UdYJ")},null,null).exports,g={name:"home",mounted:function(){this.init()},methods:{init:function(){console.log(this.$route)},handleClick:function(t){"formOcr"===t?this.$router.push("/formocr"):console.log(t)}}},w={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[this._m(0),this._v(" "),e("div",{staticClass:"footer"},[e("router-link",{attrs:{to:"/formocr"}},[e("el-button",{attrs:{type:"primary"}},[this._v("表格图片识别")])],1),this._v(" "),e("router-link",{attrs:{to:"/cardocr"}},[e("el-button",{attrs:{type:"primary",plain:""}},[this._v("批量名片识别")])],1),this._v(" "),e("router-link",{attrs:{to:"/baiduocr"}},[e("el-button",{attrs:{type:"primary",plain:""}},[this._v("通用识别")])],1)],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content"},[e("i",{staticClass:"el-icon-upload logo"}),this._v(" "),e("div",{staticClass:"title"},[this._v("图片识别Demo")])])}]};var y=s("VU/8")(g,w,!1,function(t){s("nVVb")},null,null).exports,b={name:"formocr",data:function(){return{fileList:[]}},computed:{uploadState:function(){return 0===this.fileList.length}},methods:{submitUpload:function(){this.$refs.upload.submit()},uploadSuccess:function(t,e,s){console.log(e);var i=this,a=new Image;a.onload=function(){i.imgWidth=a.width,i.imgHeight=a.height,i.$router.push({path:"draw",query:{fileUrl:e.url,imgWidth:a.width,imgHeight:a.height,fileName:e.name,imageUrl:t.path}})},a.src=e.url},changeUpload:function(t,e){console.log(t),this.fileList=e},exceedFile:function(t){this.$message({message:"每次只能上传一张图片，请先删除当前图片",type:"warning"})}}},x={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ocr-container"},[s("div",{staticClass:"content"},[s("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"","auto-upload":!1,"list-type":"'picture'",action:"./api/upload","on-success":t.uploadSuccess,"on-change":t.changeUpload,"on-exceed":t.exceedFile}},[s("i",{staticClass:"el-icon-upload"}),t._v(" "),s("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),s("em",[t._v("点击上传")])])]),t._v(" "),t._m(0),t._v(" "),s("div",{staticStyle:{width:"100%","margin-top":"30px"}},[s("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary",plain:"",disabled:t.uploadState},on:{click:t.submitUpload}},[t._v("上传文件")])],1)],1)])},staticRenderFns:[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{"text-align":"center",width:"100%"}},[s("div",{staticClass:"left-align-class"},[s("p",{staticClass:"font-14px-bold green"},[t._v("列表图片识别："),s("br")]),t._v(" "),s("p",{staticClass:"font-14px green"},[s("ol",[s("li",[t._v("图片大小不超过"),s("strong",[t._v("4M")])]),t._v(" "),s("li",[t._v("最短边边长"),s("strong",[t._v("至少15px")]),t._v(",最长边"),s("strong",[t._v("不超过4096px")])]),t._v(" "),s("li",[t._v("支持jpg/png/bmp格式")]),t._v(" "),s("li",[t._v("不需要识别的信息内容最好不要出现在图中")])])])])])}]};var R=s("VU/8")(b,x,!1,function(t){s("HjtZ")},null,null).exports,S={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ocr-container"},[s("div",{staticClass:"card-content"},[s("el-upload",{ref:"upload",staticClass:"upload-demo card-upload-demo",attrs:{drag:"","auto-upload":!1,"list-type":"'picture'",action:"./api/uploadmany","on-success":t.uploadSuccess,"on-change":t.changeUpload,"on-exceed":t.exceedFile,limit:9,multiple:""}},[s("i",{staticClass:"el-icon-upload"}),t._v(" "),s("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),s("em",[t._v("点击上传")])])]),t._v(" "),t._m(0),t._v(" "),s("div",{staticStyle:{width:"100%","margin-top":"10px"}},[s("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary",plain:"",disabled:t.uploadState},on:{click:t.submitUpload}},[t._v("上传文件")])],1)],1)])},staticRenderFns:[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{"text-align":"center",width:"100%"}},[s("div",{staticClass:"left-align-class"},[s("p",{staticClass:"font-14px-bold green"},[t._v("列表图片识别："),s("br")]),t._v(" "),s("p",{staticClass:"font-14px green"},[s("ol",[s("li",[t._v("图片大小不超过"),s("strong",[t._v("4M")])]),t._v(" "),s("li",[t._v("最短边边长"),s("strong",[t._v("至少15px")]),t._v(",最长边"),s("strong",[t._v("不超过4096px")])]),t._v(" "),s("li",[t._v("支持jpg/png/bmp格式")]),t._v(" "),s("li",[t._v("不需要识别的信息内容最好不要出现在图中")]),t._v(" "),s("li",[t._v("一次上传不超过9张图片")])])])])])}]};var C=s("VU/8")({name:"cardocr",data:function(){return{fileList:[],uploadedFiles:[]}},computed:{uploadState:function(){return 0===this.fileList.length}},methods:{submitUpload:function(){this.$refs.upload.submit()},uploadSuccess:function(t,e,s){var i=this;if(this.uploadedFiles.push(t[0]),this.uploadedFiles.length===s.length){var a=[],r=[],n=[];this.fileList.every(function(t,e){return a.push(t.url),r.push(t.name),n.push(i.uploadedFiles[e].path),!0}),this.$router.push({path:"uploadcard",query:{fileUrl:a,imageUrl:n,fileName:r}}),this.uploadedFiles=[]}},changeUpload:function(t,e){this.fileList=e},exceedFile:function(t){this.$message({message:"每次只能上传九张图片，请先删除当前图片",type:"warning"})}}},S,!1,function(t){s("w73g")},null,null).exports,U=s("mw3O"),F=s.n(U),k={name:"uploadForm",data:function(){return{ocrState:!1,requestId:"",loadingObj:null,excelUrl:""}},mounted:function(){console.log(this.$route)},computed:{fileUrl:function(){return this.$route.query.fileUrl},imageUrl:function(){return this.$route.query.imageUrl},fileName:function(){return this.$route.query.fileName}},methods:{getOcr:function(){var t=this,e=F.a.stringify({imageUrl:this.imageUrl,picType:"form_ocr_request"});this.loadingObj=this.$loading({text:"操作中，请稍后"}),this.axios.post("./api/baidu_ocr_general",e).then(function(e){var s=JSON.parse(e.data);if(s.error_code)return t.$message.error(s.error_msg),void t.loadingObj.close();t.requestId=s.result[0].request_id,t.loadingObj.close(),t.ocrState=!0})},downloadFile:function(t){this.loadingObj=this.$loading({text:"操作中，请稍后"}),this.requestFormFile(t)},requestFormFile:function(t){var e=this;this.axios.post("./api/baidu_ocr_general",F.a.stringify({picType:"form_ocr_get_request_result",requestId:this.requestId})).then(function(s){try{var i=JSON.parse(s.data);if(i.error_code)18===Number(i.error_code)?(console.log("setTimeout--in"),setTimeout(e.requestFormFile(t),1e3)):(e.$message.error(i.error_msg),e.loadingObj.close());else{var a=i.result.result_data;console.log(a),""===a?e.requestFormFile(t):(e.loadingObj.close(),"web"===t?e.processWeb(a):e.sendEmail(a))}}catch(t){e.loadingObj.close(),e.$message.error("出错了，请刷新重试吧！！！")}})},processWeb:function(t){var e=t.split("?")[0].split("/"),s=e[e.length-1],i=document.createElement("a");i.setAttribute("href",t),i.setAttribute("download",s),i.click()},restartOcr:function(){this.ocrState=!1,this.requestId="",this.$router.push("/formocr")},sendEmail:function(t){var e=this;this.$prompt("请输入邮箱","提示",{center:!0,confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/[\w!#$%&'*+/=?^_`{|}~-]+(?:\.[\w!#$%&'*+/=?^_`{|}~-]+)*@(?:[\w](?:[\w-]*[\w])?\.)+[\w](?:[\w-]*[\w])?/,inputErrorMessage:"邮箱格式不正确"}).then(function(s){var i=s.value;e.axios.post("./api/downloadformexcel",F.a.stringify({fileUrl:t,email:i})).then(function(t){console.log(t)})}).catch(function(){e.$message({type:"info",message:"取消输入"})})},editPic:function(){var t=this,e=new Image;e.onload=function(){t.imgWidth=e.width,t.imgHeight=e.height,t.$router.push({path:"draw",query:{fileUrl:t.fileUrl,imgWidth:e.width,imgHeight:e.height,fileName:t.fileName}})},e.src=this.fileUrl}}},$={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ocr-container"},[t.ocrState?t._e():s("div",{staticClass:"wrap"},[s("img",{staticClass:"image-container",attrs:{src:t.fileUrl}})]),t._v(" "),t.ocrState?t._e():s("div",{staticClass:"footer-button"},[s("el-button",{attrs:{type:"primary",plain:""},on:{click:t.getOcr}},[t._v("图片解析")]),t._v(" "),s("el-button",{attrs:{type:"primary",plain:""},on:{click:t.editPic}},[t._v("图片编辑")])],1),t._v(" "),t.ocrState?s("div",{staticClass:"content"},[s("p",{staticClass:"green"},[t._v("已成功识别:"),s("br"),t._v(" "),s("strong",[t._v(t._s(t.fileName))])]),t._v(" "),s("div",{staticStyle:{width:"100%","margin-top":"50px"}},[t.ocrState?s("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.downloadFile("web")}}},[t._v("点击下载")]):t._e(),t._v(" "),t.ocrState?s("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.downloadFile("mobile")}}},[t._v("发送到邮箱")]):t._e(),t._v(" "),t.ocrState?s("el-button",{attrs:{type:"primary",plain:""},on:{click:t.restartOcr}},[t._v("继续上传图片")]):t._e()],1)]):t._e()])},staticRenderFns:[]};var z=s("VU/8")(k,$,!1,function(t){s("/TZm")},null,null).exports,O=s("fZjL"),q=s.n(O),T=s("mvHQ"),E=s.n(T),L=s("sJst"),D=s.n(L),N={data:function(){return{animate:!0,animation:""}},props:{type:{type:String,default:"xls"},button_text:{type:String,default:"Download Excel"},data:{type:Array,required:!0},param:{type:Object,required:!0},name:{type:String,default:"data.xls"},meta:{type:Array,default:function(){return[]}}},created:function(){},computed:{id_name:function(){return"export_"+(new Date).getTime()}},methods:{generate:function(){return"csv"==this.type?this.exportCSV(this.data,this.name,this.param):this.exportXLS(this.data,this.name,this.param)},generate_excel:function(){this.exportXLS(this.data,this.name,this.param)},jsonToXLS:function(t,e){var s='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>${table}</table></body></html>',i="",a=[];if(e){for(var r in i+="<thead>",e)a.push(r),i+="<th>"+r+"</th>";return i+="</thead>",i+="<tbody>",t.map(function(t,e){i+="<tr>";for(var s=0;s<a.length;s++)if(-1!==a[s].indexOf(".")){for(var r=a[s].split("."),n=t[r[0]],o=1;o<r.length;o++)n=n[r[o]];i+="<td>"+n+"</td>"}else i+="<td>"+t[a[s]]+"</td>";i+="</tr>"}),s.replace("${table}",i+="</tbody>")}return t.map(function(t,e){for(var s in i+="<tbody><tr>",t)i+="<td>"+t[s]+"</td>";i+="</tr></tbody>"}),s.replace("${table}",i)},jsonToCSV:function(t,e){var s="";if(e){for(var i in e)s+=i+",";s=s.slice(0,s.length-1),s+="\r\n"}return t.map(function(t){for(var e in t){var i=t[e]+"";i.match(/[,"\n]/)&&(i='"'+i.replace(/\"/g,'""')+'"'),s+=i+","}s=s.slice(0,s.length-1),s+="\r\n"}),s},base64:function(t){return window.btoa(window.unescape(encodeURIComponent(t)))},exportXLS:function(t,e,s){var i="data:application/vnd.ms-excel;base64,"+this.base64(this.jsonToXLS(t,s));this.download(i,e,"application/vnd.ms-excel")},exportCSV:function(t,e,s){var i="data:application/csv;base64,"+this.base64(this.jsonToCSV(t,s));this.download(i,e,"application/csv")},base64ToBlob:function(t){for(var e=t.split(","),s=e[0].match(/:(.*?);/)[1],i=atob(e[1]),a=i.length,r=new Uint8ClampedArray(a);a--;)r[a]=i.charCodeAt(a);return new Blob([r],{type:s})},download:function(t,e,s){var i=this.base64ToBlob(t);D()(i,e,s)}}},j={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{attrs:{id:this.id_name},on:{click:this.generate}},[this._t("default",[this._v("\n\t\t"+this._s(this.button_text)+"\n\t")])],2)},staticRenderFns:[]},B={NAME:"String",ADDR:"String",MOBILE:"String",TEL:"String",FAX:"String",PC:"String",URL:"String"},A={name:"uploadForm",components:{"download-excel":s("VU/8")(N,j,!1,null,null,null).exports},data:function(){return{ocrState:!1,loadingObj:null,ocrResult:[],failedCount:0,jsonFields:B,excelData:[]}},mounted:function(){console.log(this.$route)},computed:{fileUrls:function(){return this.$route.query.fileUrl},imageUrls:function(){return this.$route.query.imageUrl},fileNames:function(){return this.$route.query.fileName}},methods:{getOcr:function(){var t=this;this.loadingObj=this.$loading({text:"操作中，请稍后"}),this.failedCount=0,this.ocrResult=[],this.imageUrls.every(function(e,s){return t.requestOcrData(e),!0})},requestOcrData:function(t){var e=this,s=F.a.stringify({imageUrl:t,picType:"business_card"});this.axios.post("./api/baidu_ocr_general",s).then(function(t){console.log(t);var s=JSON.parse(t.data);return 0===s.words_result_num||s.error_code?(e.failedCount+=1,t):(e.ocrResult.push(s.words_result),e.ocrResult.length===e.imageUrls.length-e.failedCount&&(e.excelData=e.proceedResult(),console.log(e.excelData),e.loadingObj.close(),e.ocrState=!0),t)})},downloadFile:function(){var t=this;this.$prompt("请输入邮箱","提示",{center:!0,confirmButtonText:"确定",cancelButtonText:"取消",customClass:"confirm",inputPattern:/[\w!#$%&'*+/=?^_`{|}~-]+(?:\.[\w!#$%&'*+/=?^_`{|}~-]+)*@(?:[\w](?:[\w-]*[\w])?\.)+[\w](?:[\w-]*[\w])?/,inputErrorMessage:"邮箱格式不正确"}).then(function(e){var s=e.value,i=new URLSearchParams;i.append("excelData",E()(t.excelData)),i.append("email",s),t.axios.post("./api/downloadcardexcel",i).then(function(t){console.log(t)})}).catch(function(){t.$message({type:"info",message:"取消输入"})})},proceedResult:function(){var t=[];return this.ocrResult.every(function(e,s){var i={NAME:"",ADDR:"",MOBILE:"",TEL:"",FAX:"",PC:"",URL:""};return q()(e).every(function(t,s){return i[t]=e[t].join(),!0}),t.push(i),!0}),t},restartOcr:function(){this.ocrState=!1,this.failedCount=0,this.ocrResult=[],this.excelData=[],this.$router.push("/cardocr")}}},P={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ocr-container"},[t._l(t.fileUrls,function(e,i){return t.ocrState?t._e():s("img",{key:e,staticClass:"image-cell",attrs:{src:e,alt:t.fileNames[i]}})}),t._v(" "),t.ocrState?t._e():s("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary",plain:""},on:{click:t.getOcr}},[t._v("图片解析")]),t._v(" "),t.ocrState?s("div",{staticClass:"content"},[s("p",{staticClass:"green"},[t._v("已成功识别:"),s("br"),t._v(" "),t._l(t.fileNames,function(e){return s("strong",{key:e},[t._v(t._s(e)),s("br")])})],2),t._v(" "),s("div",{staticStyle:{width:"100%","margin-top":"50px"}},[s("download-excel",{staticClass:"el-button el-button--primary is-plain",attrs:{data:t.excelData,param:t.jsonFields,button_text:"下载Excel"}}),t._v(" "),t.ocrState?s("el-button",{attrs:{type:"primary",plain:""},on:{click:t.downloadFile}},[t._v("发送到邮箱")]):t._e(),t._v(" "),t.ocrState?s("el-button",{attrs:{type:"primary",plain:""},on:{click:t.restartOcr}},[t._v("继续上传图片")]):t._e()],1)]):t._e()],2)},staticRenderFns:[]};var W=s("VU/8")(A,P,!1,function(t){s("LnGP")},null,null).exports,M={name:"draw-board",data:function(){return{context:{},imgUrl:[],canvasMoveUse:!1,canvasLabel:"开",imageData:null,config:{lineWidth:1,lineColor:"#000000",shadowBlur:2},fileUrl:this.$route.query.fileUrl,imgWidth:this.$route.query.imgWidth,imgHeight:this.$route.query.imgHeight,imageUrl:this.$route.query.imageUrl,requestId:"",fileName:this.$route.query.fileName,isVertical:!1}},mounted:function(){var t=this;this.$confirm("给表格图片添加适当的表格线将会极大地提高识别精度！快去试试吧","提示",{confirmButtonText:"确定",cancelButtonText:"跳过",type:"warning"}).then(function(){var e=t.$refs.myCanvas;console.log(t.fileUrl);var s=e.getContext("2d"),i=new Image,a=t;i.onload=function(){s.drawImage(i,0,0),a.initDraw(),a.setCanvasStyle()},i.src=t.fileUrl,t.context=s}).catch(function(){t.$router.push({path:"uploadform",query:{fileUrl:t.fileUrl,imageUrl:t.imageUrl,fileName:t.fileName}})})},methods:{canvasState:function(){this.canvasLabel=this.canvasMoveUse?"开":"关",this.canvasMoveUse=!this.canvasMoveUse},isPc:function(){for(var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],s=!0,i=0;i<e.length;i++)if(t.indexOf(e[i])>0){s=!1;break}return s},initDraw:function(){this.imageData=this.context.getImageData(0,0,this.imgWidth,this.imgHeight)},canvasUp:function(t){if(console.log("canvasUp"),this.canvasMoveUse){var e=t.offsetX,s=t.offsetY;this.context.beginPath(),this.context.moveTo(e,s),this.isVertical?this.context.lineTo(e,this.imgHeight):this.context.lineTo(this.imgWidth,s),this.context.stroke()}},clearRect:function(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),this.context.putImageData(this.imageData,0,0)},setCanvasStyle:function(){this.context.lineWidth=this.config.lineWidth,this.context.shadowBlur=this.config.shadowBlur,this.context.shadowColor=this.config.lineColor,this.context.strokeStyle=this.config.lineColor},getImage:function(){var t=this,e=this,s=document.querySelector("#canvas");HTMLCanvasElement.prototype.toBlob||this.addPollyFill(),s.toBlob(function(i){var a=new window.File([i],e.fileName,{type:"image/jpeg"}),r=new FormData;r.append("file",a),e.axios.post("./api/upload",r,{headers:{"content-type":"multipart/form-data; boundary=----WebKitFormBoundary3q4SNbnLAUih9eBx"}}).then(function(i){console.log(i),t.$router.push({path:"uploadform",query:{fileUrl:s.toDataURL("image/png"),imageUrl:i.data.path,fileName:e.fileName}})})})},addPollyFill:function(){HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,s){for(var i=atob(this.toDataURL(e,s).split(",")[1]),a=i.length,r=new Uint8Array(a),n=0;n<a;n++)r[n]=i.charCodeAt(n);t(new Blob([r],{type:e||"image/png"}))}})}}},I={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ocr-container"},[s("div",{staticClass:"wrap"},[s("div",{staticClass:"canvas-container wrapContainer"},[s("canvas",{ref:"myCanvas",staticClass:"fl",attrs:{id:"canvas",width:parseInt(t.imgWidth),height:parseInt(t.imgHeight)},on:{mouseup:function(e){t.canvasUp(e)},touchend:function(e){t.canvasUp(e)}}})])]),t._v(" "),s("div",{staticClass:"footer-button"},[s("el-button-group",[s("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:function(e){t.isVertical=!1}}},[t._v("画横线")]),t._v(" "),s("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:function(e){t.isVertical=!0}}},[t._v("画竖线")]),t._v(" "),s("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:function(e){t.clearRect()}}},[t._v("清除")]),t._v(" "),s("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:function(e){t.getImage()}}},[t._v("画好了")]),t._v(" "),s("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:function(e){t.canvasState()}}},[t._v(t._s(t.canvasLabel))])],1)],1)])},staticRenderFns:[]};var V=s("VU/8")(M,I,!1,function(t){s("7qfE")},null,null).exports;i.default.use(n.a);var H=new n.a({routes:[{path:"/",name:"index",component:y},{path:"/baiduocr",name:"BaiduOCR",component:f},{path:"/home",name:"home",component:y},{path:"/formocr",name:"FormOcr",component:R},{path:"/cardocr",name:"CardOcr",component:C},{path:"/uploadform",name:"UploadForm",props:!0,component:z},{path:"/uploadcard",name:"UploadCard",props:!0,component:W},{path:"/draw",name:"Draw",component:V}]}),J=s("mtWM"),X=s.n(J),K=s("zL8q"),Z=s.n(K),G=(s("tvR6"),s("Au9i")),Q=s.n(G),Y=(s("d8/S"),s("fC7K"));i.default.use(Z.a),i.default.use(Q.a),i.default.use(Y.a),i.default.config.productionTip=!1,i.default.prototype.axios=X.a,new i.default({el:"#app",router:H,components:{App:r},template:"<App/>"})},Q4kC:function(t,e){},UdYJ:function(t,e){},"d8/S":function(t,e){},nVVb:function(t,e){},tvR6:function(t,e){},w73g:function(t,e){},ydBP:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.5e39dba95018f400bed4.js.map